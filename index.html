<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Koolchaine</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #f0f0f0;
        }
        #rive-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        #status {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div id="status">Chargement...</div>
    <canvas id="rive-canvas"></canvas>
    
    <!-- Utilisation de la dernière bibliothèque stable -->
    <script src="https://unpkg.com/@rive-app/canvas-advanced@2.7.0"></script>
    <script>
        const statusElement = document.getElementById('status');
        const canvas = document.getElementById('rive-canvas');
        
        // Afficher les dimensions du canvas pour débogage
        const logCanvasDimensions = () => {
            console.log('Canvas dimensions:', {
                clientWidth: canvas.clientWidth,
                clientHeight: canvas.clientHeight,
                width: canvas.width,
                height: canvas.height
            });
        };
        
        // Définir les dimensions du canvas pour qu'elles correspondent à la taille de l'écran
        const setCanvasDimensions = () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            logCanvasDimensions();
        };
        
        window.addEventListener('resize', setCanvasDimensions);
        setCanvasDimensions();
        
        // Charger le fichier Rive
        statusElement.textContent = "Initialisation de Rive...";
        
        // Chemin vers le fichier .riv - assurez-vous que ce chemin est exact
        const rivePath = 'koolchaine_v1.riv';
        
        // Logs pour le débogage
        console.log('Tentative de chargement du fichier:', rivePath);
        
        // Utilisation de la nouvelle version de l'API Rive
        const loadRive = async () => {
            try {
                if (!window.rive) {
                    throw new Error("La bibliothèque Rive n'a pas été chargée correctement");
                }
                
                statusElement.textContent = "Chargement du fichier Rive...";
                
                // Vérifier l'existence du fichier
                try {
                    const response = await fetch(rivePath, { method: 'HEAD' });
                    if (!response.ok) {
                        throw new Error(`Le fichier ${rivePath} est introuvable (statut: ${response.status})`);
                    }
                } catch (fetchError) {
                    statusElement.innerHTML = `<strong>Erreur:</strong> Impossible d'accéder au fichier Rive.<br>Vérifiez que le fichier existe et est accessible.`;
                    console.error('Erreur de fetch:', fetchError);
                    return;
                }
                
                // Initialiser le runtime Rive
                const r = new rive.Rive({
                    src: rivePath,
                    canvas: canvas,
                    autoplay: true,
                    layout: new rive.Layout({
                        fit: rive.Fit.Cover
                    }),
                    onLoad: () => {
                        statusElement.style.display = 'none';
                        console.log('Animation Rive chargée avec succès');
                    },
                    onLoadError: (err) => {
                        console.error('Erreur de chargement Rive:', err);
                        statusElement.innerHTML = `<strong>Erreur de chargement:</strong> ${err}<br><br>Conseil: Vérifiez que le fichier .riv est bien dans votre dépôt GitHub et que son nom est exactement 'koolchaine_v1.riv'`;
                    }
                });
                
                // Vérification après délai
                setTimeout(() => {
                    if (statusElement.style.display !== 'none') {
                        console.log('Animation non chargée après timeout');
                        statusElement.innerHTML += '<br><br>Essayez de rafraîchir la page ou vérifiez la console pour plus de détails.';
                    }
                }, 8000);
                
            } catch (error) {
                console.error('Erreur lors de l\'initialisation:', error);
                statusElement.innerHTML = `<strong>Erreur:</strong> ${error.message}<br><br>Veuillez vérifier la console pour plus de détails.`;
            }
        };
        
        // Exécuter lorsque la page est chargée
        window.addEventListener('DOMContentLoaded', loadRive);
    </script>
</body>
</html>
